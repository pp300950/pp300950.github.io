<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ESP8266 Control Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;700&display=swap" rel="stylesheet">
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <style>
        body { font-family: 'Kanit', sans-serif; }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á */
        .control-btn:active {
            transform: scale(0.95);
            filter: brightness(1.2);
        }
    </style>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
        import { getDatabase, ref, onValue, set } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';

        // ====================================================================
        // 1. CONFIGURATION
        // ====================================================================
        const ESP_BOARD_IP = '10.215.136.64'; // *** ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï IP ‡∏Ç‡∏≠‡∏á ESP8266 ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ***
        const firebaseConfig = {
            apiKey: 'AIzaSyDWBYanYUah9F7-qk-GajoI39yx8dClXSQ',
            authDomain: 'd1contro.firebaseapp.com',
            databaseURL: 'https://d1contro-default-rtdb.asia-southeast1.firebasedatabase.app',
            projectId: 'd1contro',
            storageBucket: 'd1contro.firebasestorage.app',
            messagingSenderId: '980765975797',
            appId: '1:980765975797:web:9cd0d3bef60b522e6611bc',
            measurementId: 'G-16JZGVMVPK',
        };

        // ====================================================================
        // 2. CORE LOGIC
        // ====================================================================
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);
        const logArea = document.getElementById('log-area');
        const boardStatusElement = document.getElementById('board-status');
        
        // ** NEW: ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏•‡∏¢‡πå **
        let currentRelayStates = { R1: 0, R2: 0 };

        const mapState = (value) => (value === 1 ? 'ON' : 'OFF');

        function log(message, type = 'info') {
            const time = new Date().toLocaleTimeString('th-TH');
            let color = 'text-gray-400';
            if (type === 'success') color = 'text-green-400';
            if (type === 'error') color = 'text-red-400';
            if (type === 'event') color = 'text-cyan-400';
            if (type === 'action') color = 'text-yellow-400';

            const logEntry = document.createElement('p');
            logEntry.className = `text-sm font-mono ${color} break-words`;
            logEntry.innerHTML = `<span class="text-gray-500">[${time}]</span> ${message}`;
            logArea.prepend(logEntry);
        }

        function clearLog() {
            logArea.innerHTML = '';
            log('Console cleared.', 'info');
        }
        window.clearLog = clearLog;

        async function sendCommandToEsp(relay, state) {
            const action = state === 1 ? 'ON' : 'OFF'; 
            const url = `http://${ESP_BOARD_IP}/control/${relay}/${action}`;
            // ** ‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô **
            const repeatCount = 1; 
            const delayBetweenRequests = 10;

            log(`[ACTION] Sending command ${relay}/${action}...`, 'action');
            boardStatusElement.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á...`;
            boardStatusElement.className = 'text-yellow-500 font-bold';
            
            const delay = (ms) => new Promise(res => setTimeout(res, ms));

            for (let i = 0; i < repeatCount; i++) {
                fetch(url, { method: 'GET', signal: AbortSignal.timeout(1000) })
                    .catch(e => { /* ‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à error */ });
                if (repeatCount > 1) await delay(delayBetweenRequests);
            }

            boardStatusElement.textContent = '‡∏£‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á...';
            boardStatusElement.className = 'text-gray-400 font-bold';
            log(`[SUCCESS] Command sent to ${relay}.`, 'success');
        }
        
        async function controlRelay(relay, state) {
            // ** ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≥‡πÜ ‡∏ñ‡πâ‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á **
            if (currentRelayStates[relay] === state) return;

            log(`[UI ACTION] User set ${relay} to ${mapState(state)}`, 'action');
            const relayRef = ref(db, relay);
            try {
                await set(relayRef, state);
            } catch (error) {
                log(`[ERROR] Failed to set ${relay} on Firebase: ${error.message}`, 'error');
            }
        }
        window.controlRelay = controlRelay;

        // ** NEW: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤ **
        async function controlForward(isPressed) {
            const state = isPressed ? 1 : 0;
            const actionText = isPressed ? "FORWARD" : "STOP";
            log(`[UI ACTION] User set ${actionText}`, 'action');
            // ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
            await Promise.all([
                controlRelay('R1',  1 - state),
                controlRelay('R2',  1 - state)
            ]);
        }
        window.controlForward = controlForward;
        
        // ** REVISED: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI ‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÉ‡∏´‡∏°‡πà **
        function updateControllerUI() {
            const leftBtn = document.getElementById('left-button');
            const rightBtn = document.getElementById('right-button');
            const forwardBtn = document.getElementById('forward-button');
            
            const activeClasses = ['bg-yellow-500', 'text-black', 'shadow-yellow-400/50'];
            const inactiveClasses = ['bg-gray-700', 'text-white', 'hover:bg-gray-600'];

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°‡∏ã‡πâ‡∏≤‡∏¢
            if (currentRelayStates.R1 === 1) {
                leftBtn.classList.remove(...inactiveClasses);
                leftBtn.classList.add(...activeClasses);
            } else {
                leftBtn.classList.remove(...activeClasses);
                leftBtn.classList.add(...inactiveClasses);
            }

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏ß‡∏≤
            if (currentRelayStates.R2 === 1) {
                rightBtn.classList.remove(...inactiveClasses);
                rightBtn.classList.add(...activeClasses);
            } else {
                rightBtn.classList.remove(...activeClasses);
                rightBtn.classList.add(...inactiveClasses);
            }

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤
            if (currentRelayStates.R1 === 1 && currentRelayStates.R2 === 1) {
                forwardBtn.classList.remove(...inactiveClasses);
                forwardBtn.classList.add(...activeClasses);
            } else {
                forwardBtn.classList.remove(...activeClasses);
                forwardBtn.classList.add(...inactiveClasses);
            }
        }

        function setupFirebaseListeners() {
            log('Firebase Client App initialized.', 'success');

            signInAnonymously(auth)
                .then(() => {
                    log('Signed in anonymously successfully.', 'info');
                    document.getElementById('firebase-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
                    document.getElementById('firebase-status').className = 'text-green-500 font-bold';
                })
                .catch((error) => {
                    log(`[ERROR] Firebase Auth/Config Failed: ${error.message}.`, 'error');
                    document.getElementById('firebase-status').textContent = 'Config Error';
                    document.getElementById('firebase-status').className = 'text-red-500 font-bold';
                });

                const r1Ref = ref(db, 'R1');
            onValue(r1Ref, (snapshot) => {
                const newState = snapshot.val();
                if (typeof newState === 'number') {
                    log(`[‡∏ã‡πâ‡∏≤‡∏¢/R1 EVENT] Firebase reports state is ${mapState(newState)} (${newState})`, 'event');
                    currentRelayStates.R1 = newState; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                    updateControllerUI(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI

                    // =======================================================
                    // ‚ú® ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç if/else ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
                    // =======================================================
                    let stateToSendToEsp;
                    if (newState === 1) {
                        // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Firebase ‡∏Ñ‡∏∑‡∏≠ 1 (‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á '‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°')
                        // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ ESP ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 0
                        stateToSendToEsp = 0;
                        log('[INVERT LOGIC] newState is 1, sending 0 to ESP.', 'action');
                    } else {
                        // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Firebase ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô (‡∏Ñ‡∏∑‡∏≠ 0, ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á '‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏∏‡πà‡∏°')
                        // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ ESP ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 1
                        stateToSendToEsp = 1;
                        log('[INVERT LOGIC] newState is 0, sending 1 to ESP.', 'action');
                    }
                    sendCommandToEsp('R1', stateToSendToEsp);
                    // =======================================================
                }
            });

            const r2Ref = ref(db, 'R2');
            onValue(r2Ref, (snapshot) => {
                const newState = snapshot.val();
                if (typeof newState === 'number') {
                    log(`[‡∏Ç‡∏ß‡∏≤/R2 EVENT] Firebase reports state is ${mapState(newState)} (${newState})`, 'event');
                    currentRelayStates.R2 = newState; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                    updateControllerUI(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI

                    // =======================================================
                    // ‚ú® ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç if/else ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
                    // =======================================================
                    let stateToSendToEsp;
                     if (newState === 1) {
                        // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Firebase ‡∏Ñ‡∏∑‡∏≠ 1 (‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á '‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°')
                        // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ ESP ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 0
                        stateToSendToEsp = 0;
                        log('[INVERT LOGIC] newState is 1, sending 0 to ESP.', 'action');
                    } else {
                        // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Firebase ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô (‡∏Ñ‡∏∑‡∏≠ 0, ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á '‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏õ‡∏∏‡πà‡∏°')
                        // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ ESP ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô 1
                        stateToSendToEsp = 1;
                        log('[INVERT LOGIC] newState is 0, sending 1 to ESP.', 'action');
                    }
                    sendCommandToEsp('R2', stateToSendToEsp);
                    // =======================================================
                }
            });

            log('Listeners started. Waiting for Firebase events...', 'info');
        }

        // ** NEW: ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listeners ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ **
        function setupButtonListeners() {
            const leftBtn = document.getElementById('left-button');
            const rightBtn = document.getElementById('right-button');
            const forwardBtn = document.getElementById('forward-button');
            
            const addMomentaryListeners = (element, relayId) => {
                element.addEventListener('mousedown', () => controlRelay(relayId, 1));
                element.addEventListener('mouseup', () => controlRelay(relayId, 0));
                element.addEventListener('mouseleave', () => controlRelay(relayId, 0)); // ‡∏Å‡∏£‡∏ì‡∏µ‡∏•‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏≠‡∏≠‡∏Å
                element.addEventListener('touchstart', (e) => { e.preventDefault(); controlRelay(relayId, 1); });
                element.addEventListener('touchend', (e) => { e.preventDefault(); controlRelay(relayId, 0); });
            };

            const addForwardListeners = (element) => {
                element.addEventListener('mousedown', () => controlForward(true));
                element.addEventListener('mouseup', () => controlForward(false));
                element.addEventListener('mouseleave', () => controlForward(false));
                element.addEventListener('touchstart', (e) => { e.preventDefault(); controlForward(true); });
                element.addEventListener('touchend', (e) => { e.preventDefault(); controlForward(false); });
            };

            addMomentaryListeners(leftBtn, 'R1');
            addMomentaryListeners(rightBtn, 'R2');
            addForwardListeners(forwardBtn);
        }

        window.onload = () => {
            document.getElementById('esp-ip-display').textContent = ESP_BOARD_IP;
            setupFirebaseListeners();
            setupButtonListeners(); // ** ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Listener **
        };

    </script>
</head>

<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">

    <div class="max-w-7xl w-full bg-gray-800/50 backdrop-blur-sm rounded-2xl shadow-2xl overflow-hidden border border-gray-700">
        <div class="bg-gray-900/70 p-5 border-b border-gray-700">
            <h1 class="text-2xl font-bold flex items-center gap-3">
                <ion-icon name="game-controller-outline" class="text-cyan-400"></ion-icon>
                ESP8266 Control Panel
            </h1>
            <p class="mt-1 text-gray-400 text-sm">‡∏ï‡∏±‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° ESP8266 ‡∏ú‡πà‡∏≤‡∏ô Firebase Realtime Database</p>
        </div>

        <div class="p-6 grid grid-cols-1 lg:grid-cols-5 gap-6">

            <div class="lg:col-span-2 flex flex-col items-center justify-center bg-gray-800 p-6 rounded-lg border border-gray-700 shadow-lg">
                <h2 class="text-xl font-bold text-white mb-6">üïπÔ∏è ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°</h2>
                <div class="grid grid-cols-3 grid-rows-2 gap-4 w-full max-w-xs mx-auto">
                    
                    <div class="col-start-2 flex justify-center">
                         <button id="forward-button" class="control-btn w-20 h-20 bg-gray-700 text-white font-bold rounded-full flex items-center justify-center transition-all duration-150 shadow-lg hover:bg-gray-600">
                            <ion-icon name="arrow-up-outline" class="text-4xl"></ion-icon>
                        </button>
                    </div>

                    <div class="col-start-1 row-start-2 flex justify-center">
                        <button id="left-button" class="control-btn w-20 h-20 bg-gray-700 text-white font-bold rounded-full flex items-center justify-center transition-all duration-150 shadow-lg hover:bg-gray-600">
                             <ion-icon name="arrow-back-outline" class="text-4xl"></ion-icon>
                        </button>
                    </div>

                    <div class="col-start-3 row-start-2 flex justify-center">
                         <button id="right-button" class="control-btn w-20 h-20 bg-gray-700 text-white font-bold rounded-full flex items-center justify-center transition-all duration-150 shadow-lg hover:bg-gray-600">
                           <ion-icon name="arrow-forward-outline" class="text-4xl"></ion-icon>
                        </button>
                    </div>

                </div>
                 <div class="mt-6 text-center text-gray-400">
                    <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà</p>
                    <p class="text-xs mt-1">(‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)</p>
                </div>
            </div>

            <div class="lg:col-span-3 flex flex-col gap-6">
                <div class="bg-gray-800 p-5 rounded-lg border border-gray-700 shadow-lg">
                    <h2 class="text-xl font-bold text-white mb-3">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h2>
                    <div class="space-y-2 text-sm">
                        <p class="flex justify-between items-center">
                            <span class="font-medium text-gray-300">Firebase (Cloud)</span>
                            <span id="firebase-status" class="text-yellow-500 font-bold ml-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
                        </p>
                        <hr class="border-gray-700">
                        <p class="flex justify-between items-center">
                            <span class="font-medium text-gray-300">ESP8266 (Local)</span>
                            <span id="board-status" class="text-gray-400 font-bold ml-2">‡∏£‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á...</span>
                        </p>
                    </div>
                </div>

                <div class="bg-black/50 p-4 rounded-lg shadow-inner h-96 flex flex-col border border-gray-700">
                     <div class="flex justify-between items-center mb-2 border-b border-gray-700 pb-2">
                         <h2 class="text-lg font-mono text-cyan-400">>> Console Log</h2>
                         <button onclick="window.clearLog()" class="text-xs bg-gray-700 hover:bg-red-600 text-white font-semibold px-3 py-1 rounded-md transition-colors">Clear Log</button>
                     </div>
                    <div id="log-area" class="space-y-1 overflow-y-auto flex-grow pr-2">
                        <p class="text-sm font-mono text-gray-500">[INIT] Starting local web bridge...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="bg-gray-900/70 p-3 text-center border-t border-gray-700">
             <p class="text-xs text-yellow-500">
                 <span class="font-bold">‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</span> ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö ESP8266 ‡∏ó‡∏µ‡πà IP: 
                 <span class="font-mono font-bold bg-yellow-900/50 text-yellow-300 px-1.5 py-0.5 rounded-md" id="esp-ip-display"></span> 
                 ‡πÉ‡∏ô‡∏ß‡∏á Wi-Fi ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firewall
             </p>
        </div>
    </div>

</body>
</html>
