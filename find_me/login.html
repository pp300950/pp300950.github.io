<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>เข้าสู่ระบบ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Thai&display=swap');
        
        body { 
            background: #f0f6f6; 
            font-family: 'Noto Sans Thai', sans-serif;
            color: #222; 
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .login-box { 
            width: 350px;
            background: #fff; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
            text-align: center;
        }
        h1 { 
            margin-top: 0; 
            color: #333; 
        }
        .puzzle-container {
            border: 2px dashed #ccc;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            height: 100px;
        }
        .puzzle-number {
            position: absolute;
            font-size: 24px;
            font-weight: bold;
            color: #005a9c;
        }
        #num1 { top: 10px; left: 10px; }
        #num2 { top: 10px; right: 10px; }
        #num3 { bottom: 10px; left: 10px; }
        #num4 { bottom: 10px; right: 10px; }

        input[type="password"] {
            width: 100%;
            padding: 12px;
            font-size: 18px;
            font-family: 'Courier New', monospace;
            margin-top: 8px;
            border-radius: 6px;
            border: 1px solid #ccc;
            box-sizing: border-box;
            text-align: center;
        }
        button.login-btn {
            margin-top: 20px;
            width: 100%;
            padding: 12px 16px;
            background: #007bff;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
        }

        /* --- CSS สำหรับเครื่องคิดเลข (ส่วนที่เพิ่มเข้ามา) --- */
        .calculator {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .calculator h4 {
            margin: 0 0 10px 0;
            color: #666;
            font-weight: normal;
        }
        .calculator input {
            width: 80px;
            padding: 8px;
            font-size: 16px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .calculator button {
            padding: 8px 12px;
            font-size: 16px;
            margin: 0 5px;
            cursor: pointer;
        }
        .calculator .result {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        /* --- จบส่วน CSS เครื่องคิดเลข --- */

    </style>
</head>
<body>

<div class="login-box">
    <h1>กรอกรหัสผ่าน</h1>
    <p id="hintText">กำลังโหลดคำใบ้...</p>

    <div class="puzzle-container">
        <span id="num1" class="puzzle-number"></span>
        <span id="num2" class="puzzle-number"></span>
        <span id="num3" class="puzzle-number"></span>
        <span id="num4" class="puzzle-number"></span>
    </div>

    <input type="password" id="passwordInput" placeholder="กรอกรหัสที่นี่">
    <button class="login-btn" onclick="checkPassword()">เข้าสู่ระบบ</button>

    <div class="calculator">
        <h4>เครื่องคิดเลข (บวก)</h4>
        <input type="number" id="calcInput1" placeholder="เลขตัวแรก">
        <span>+</span>
        <input type="number" id="calcInput2" placeholder="เลขตัวที่สอง">
        <button onclick="calculateSum()">=</button>
        <span class="result" id="calcResult">?</span>
    </div>
    </div>

<script>
    let correctAnswer;

    function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i=0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }

    window.onload = function() {
        function getRandomNumber() {
            return Math.floor(Math.random() * 98) + 2;
        }

        const num1 = getRandomNumber();
        const num2 = getRandomNumber();
        const num3 = getRandomNumber();
        const num4 = getRandomNumber();

        document.getElementById('num1').innerText = num1;
        document.getElementById('num2').innerText = num2;
        document.getElementById('num3').innerText = num3;
        document.getElementById('num4').innerText = num4;

        const hintKey = getCookie('puzzleHint');
        const hintElement = document.getElementById('hintText');
        
        switch(hintKey) {
            case 'tr_bl':
                hintElement.innerText = 'รหัสคือผลรวมของเลขมุมบนขวาและมุมล่างซ้าย';
                correctAnswer = num2 + num3;
                break;
            case 't_b':
                hintElement.innerText = 'รหัสคือผลรวมของเลขมุมบนทั้งสองและมุมล่างทั้งสอง';
                correctAnswer = (num1 + num2) + (num3 + num4);
                break;
            case 'l_r':
                 hintElement.innerText = 'รหัสคือผลรวมของเลขด้านซ้ายทั้งหมดและด้านขวาทั้งหมด';
                 correctAnswer = (num1 + num3) + (num2 + num4);
                 break;
            case 'tl_br':
            default:
                hintElement.innerText = 'รหัสคือผลรวมของเลขมุมบนซ้ายและมุมล่างขวา';
                correctAnswer = num1 + num4;
                break;
        }
        
        console.log(`คำใบ้: ${hintElement.innerText}`);
        console.log(`รหัสที่ถูกต้องคือ ${correctAnswer}`);
    };

    function checkPassword() {
        const userInput = document.getElementById('passwordInput').value;
        if (userInput === "") {
            alert("กรุณากรอกรหัสผ่าน!");
            return;
        }
        const userPassword = parseInt(userInput);
        if (userPassword === correctAnswer) {
            window.location.href = 'final_page.html';
        } else {
            alert("รหัสผ่านไม่ถูกต้อง!");
        }
    }

    // --- JavaScript สำหรับเครื่องคิดเลข (ส่วนที่เพิ่มเข้ามา) ---
    function calculateSum() {
        // ดึงค่าจากช่องกรอกตัวเลข
        const input1 = document.getElementById('calcInput1').value;
        const input2 = document.getElementById('calcInput2').value;

        // แปลงค่าเป็นตัวเลข (ถ้าว่างให้เป็น 0)
        const num1 = parseFloat(input1) || 0;
        const num2 = parseFloat(input2) || 0;

        // คำนวณผลรวม
        const sum = num1 + num2;

        // แสดงผลลัพธ์
        document.getElementById('calcResult').innerText = sum;
    }
    // --- จบส่วน JavaScript เครื่องคิดเลข ---

</script>

</body>
</html>